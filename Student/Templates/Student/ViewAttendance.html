<!DOCTYPE html>
<html>
<head>
    <title>View Attendance</title>
</head>
<body>

<h2>My Attendance</h2>

<form method="post">
    {% csrf_token %}

    <table border="1" cellpadding="10">
        <tr>
            <td>Select Semester</td>
            <td>
                <select name="sel_semester" required>
                    <option value="">-- Select Semester --</option>
                    {% for s in semesterdata %}
                    <option value="{{ s.id }}"
                        {% if s.id|stringformat:"s" == selected_semester %}selected{% endif %}>
                        {{ s.semester_name }}
                    </option>
                    {% endfor %}
                </select>
            </td>
        </tr>

        <tr>
            <td>From Date</td>
            <td>
                <input type="date" name="from_date" value="{{ from_date }}">
            </td>
        </tr>

        <tr>
            <td>To Date</td>
            <td>
                <input type="date" name="to_date" value="{{ to_date }}">
            </td>
        </tr>

        <tr>
            <td colspan="2" align="center">
                <button type="submit">View Attendance</button>
            </td>
        </tr>
    </table>

</form>

<hr>

<!-- Overall Attendance Percentage -->
{% if overall_percentage is not None %}
<h3>
    Overall Attendance :
    <span style="color:blue;">
        {{ overall_percentage|floatformat:2 }}%
    </span>
</h3>
{% endif %}

<!-- Attendance Table -->
<table border="1" cellpadding="10" width="100%">
    <tr>
        <th>Date</th>
        <th>Subject</th>
        <th>Teacher</th>
        <th>Hour</th>
        <th>Status</th>
    </tr>

    {% if attendancedata %}
        {% for a in attendancedata %}
        <tr>
            <td>{{ a.date }}</td>
            <td>{{ a.subject.subject_name }}</td>
            <td>{{ a.teacher.teacher_name }}</td>
            <td>{{ a.hour }}</td>
            <td>
                {% if a.status == 1 %}
                    <span style="color:green; font-weight:bold;">Present</span>
                {% else %}
                    <span style="color:red; font-weight:bold;">Absent</span>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="5" align="center">
                No attendance records found
            </td>
        </tr>
    {% endif %}
</table>

</body>
</html>