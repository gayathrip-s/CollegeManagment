<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assignsubject</title>
</head>

<body>
  <form action="" method="post">
    {% csrf_token %}
    <table border="1">
      <tr>
        <td>Department</td>
        <td><select name="sel_department" id="sel_department">
            <option value="">---select---</option>
            {% for i in departmentdata %}
            <option value="{{i.id}}">{{i.department_name}}</option>
            {% endfor %}
          </select>
        </td>
      </tr>
      <tr>
        <td>Course</td>
        <td><select name="sel_course" id="sel_course">
            <option value="">---select---</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>Semester</td>
        <td><select name="sel_semester" id="sel_semester">
            <option value="">---select---</option>
            {% for i in semesterdata %}
            <option value="{{i.id}}">{{i.semester_name}}</option>
            {% endfor %}
          </select></td>
      </tr>
      <tr>
        <td>Subject</td>
        <td><select name="sel_subject" id="sel_subject">
            <option value="">---select---</option>
          </select></td>
      </tr>
      <tr>
        <td>Academic Year</td>
        <td><select name="sel_academicyear" id="sel_academicyear">
            <option value="">---select---</option>
            {% for i in academicyeardata %}
            <option value="{{i.id}}">{{i.academicyear_name}}</option>
            {% endfor %}
          </select>
        </td>
      </tr>
      <tr>

        <td colspan="2" align="center"><input type="submit" value="submit"></td>
      </tr>
    </table>
  </form>
  <br>
  <table border="1">
    <tr>
      <td>SlNo</td>
      <td>Department</td>
      <td>Course</td>
      <td>Semester</td>
      <td>Subject</td>
      <td>Academic year</td>
      <td>Action</td>
    </tr>
    {% for i in assignsubjectdata %}
    <tr>
      <td>{{ forloop.counter }}</td>
      <td>{{ i.subject.course.department.department_name }}</td>
      <td>{{ i.subject.course.course_name }}</td>
      <td>{{ i.subject.semester.semester_name }}</td>
      <td>{{ i.subject.subject_name }}</td>
      <td>{{ i.academicyear.academicyear_name }}</td>
      <td><a href="">Delete</a></td>
    </tr>
    {% endfor %}
  </table>
</body>

</html>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  $("#sel_department").change(function () {
    var disid = $(this).val();
    var ur = "{% url 'Admin:Ajaxcourse' %}";
    $.ajax({
      url: ur,
      data: { disid: disid },
      success: function (data) {
        $("#sel_course").html(data);
      },
    });
  });
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  $("#sel_semester").change(function () {
    var subid = $(this).val();
    var coid = document.getElementById("sel_course").value;
    var ur = "{% url 'Admin:Ajaxsubject' %}";
    $.ajax({
      url: ur,
      data: { subid: subid, coid: coid },
      success: function (data) {
        $("#sel_subject").html(data);
      },
    });
  });
</script>

{% if msg %}
<script>
  alert("{{msg}}")
  window.location = "{% url 'Admin:Assignsubject' %}"
</script>
{% endif %}